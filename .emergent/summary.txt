<analysis>
The trajectory outlines the development of a Pilgrim Portal application, evolving from a mock-data-driven MVP into a full-stack solution with a comprehensive admin panel. The work was executed in three distinct, user-approved phases.

Phase 1 involved building a complete FastAPI backend. This included defining Pydantic models, creating CRUD API endpoints for all data entities (hotels, tours, etc.), and writing a migration script to populate a MongoDB database from existing frontend mock files. The AI engineer thoroughly tested all endpoints.

Phase 2 focused on frontend integration. The engineer created a centralized API service and systematically refactored all public-facing pages (Home, Search Results, Hotel Details, etc.) to fetch data from the new backend instead of local mock files, implementing loading states for better UX.

Phase 3 was the creation of a feature-rich admin panel. This began with authentication, a dashboard, and a full CRUD manager for Hotels. Following user requests, the panel was expanded to include managers for all content types. A key development was addressing a user concern about data sources by creating a sophisticated, drag-and-drop Home Page Builder and a dedicated API Manager to configure connections to an external ACF Journeys API, resolving the conflict between internal and external data management.

The latest task involves implementing the logic for this API switch, starting with the hotel data fetches. The user's primary language is English; future interactions should continue in English.
</analysis>

<product_requirements>
The project is a Ziyarat Portal, a responsive frontend application for a pilgrimage booking platform. The goal is to provide a professional and feature-rich user experience for booking tours, hotels, and planning custom trips, while also giving administrators powerful tools for content management.

**Implemented Features:**
*   **Full-Stack Architecture:** The application has a complete FastAPI backend with a MongoDB database, serving data to a React frontend.
*   **Comprehensive Admin Panel:** A secure admin area with authentication allows for extensive content management. Key features include:
    *   A drag-and-drop **Home Page Builder** for complete control over the landing page layout and content.
    *   CRUD managers for internal content like Cities and Testimonials.
    *   An **API Manager** to configure and toggle connections to an external ACF Journeys API for dynamic data like Hotels, Packages, and Group Tours.
*   **Data-Driven Frontend:** All public pages (Home, Hotel/Group listings, Details) are now powered by the backend API, replacing the initial mock data.
*   **Original MVP Features:** The app retains its core features like the Iraq Ziyarat Guide and a multi-step custom trip planner, which are now ready for backend integration.
</product_requirements>

<key_technical_concepts>
- **Frameworks:** React (frontend), FastAPI (backend).
- **Database:** MongoDB.
- **Styling:** Tailwind CSS.
- **Key Libraries:**  for routing,  for drag-and-drop functionality,  for icons.
- **Architecture:**
    - Client-Server model with a RESTful API.
    - Separate layouts for public and admin areas (, ).
    - Centralized API service () with logic to dynamically switch between internal DB and external API data sources based on admin configuration.
</key_technical_concepts>

<code_architecture>
The application is a monorepo with a React frontend and a Python/FastAPI backend. The architecture is designed for a clean separation of concerns between the user-facing site and the administrative panel.


- ** & **
    - **Importance:** These files form the entire backend.  defines the Pydantic data models, and  establishes all the FastAPI CRUD endpoints that serve data to the frontend.
    - **Changes:** Created from scratch in Phase 1 to build the application's backend logic and API.

- ****
    - **Importance:** This is the data-fetching nerve center of the frontend. It centralizes all communication with the backend. It's designed to be flexible, supporting the dynamic switch between fetching data from the internal database and the external ACF Journeys API.
    - **Changes:** Created in Phase 2 to eliminate mock data usage. It is currently being modified to implement the logic for fetching from external APIs as configured in the .

- ****
    - **Importance:** This is a highly advanced, feature-rich admin component. It provides a drag-and-drop interface for an administrator to completely customize the layout and content of the public home page.
    - **Changes:** Created in Phase 3 in response to a user request for more powerful home page management, replacing a simpler form-based manager. It uses .

- ****
    - **Importance:** This component is the solution to the strategic conflict between managing data internally vs. using an external provider. It provides a UI for administrators to configure, enable/disable, and test API connections for Hotels, Packages, and Group Tours.
    - **Changes:** Created near the end of the trajectory to give the user control over the data source for key dynamic content.

- ****
    - **Importance:** The main router for the React application. It uses  to direct traffic to the correct page and crucially wraps routes in either a  or an  to separate the two application areas.
    - **Changes:** Heavily edited throughout Phase 3 to add routes for the numerous admin management pages.
</code_architecture>

<pending_tasks>
- **Complete External API Integration:** Finish updating  to handle external API calls for Group Tours and Packages, similar to what was started for Hotels.
- **Frontend Component Adaptation:** Ensure frontend pages that consume Hotel, Package, and Group Tour data can handle the data structure from the new external API.
- **Remove Redundant Admin Managers:** Once the API Manager is fully integrated, remove the internal CRUD managers for Hotels, Group Tours, and Packages from the admin panel to avoid confusion.
- **Connect Remaining Pages:** Integrate the  and  pages with their respective backend APIs.
</pending_tasks>

<current_work>
The current task is to complete the integration of the external ACF Journeys API as the primary data source for hotels, packages, and group tours, a feature managed via the newly created  in the admin panel.

Work was focused on refactoring the central data fetching service, . The goal is to make the data-fetching functions dynamic: they should first check if an external API is configured and enabled in the . If so, they fetch from that external source; otherwise, they fall back to the application's internal backend API.

The AI engineer had already started implementing this logic. It successfully updated the  and  functions to incorporate this conditional fetching mechanism. The work was interrupted immediately before applying the same pattern to the functions for Group Tours and Packages.

The  file is currently in a partially updated state, with the Hotel functions modernized but the Group Tour and Package functions still using the old, internal-only API logic.
</current_work>

<optional_next_step>
Continue updating  to add external API support with an internal fallback for the Group Tours and Packages functions, mirroring the logic just implemented for Hotels.
</optional_next_step>
